{"componentChunkName":"component---src-templates-post-js","path":"/articles/improving-jekyll-static-comments/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Improving static comments with Jekyll & Staticman","date":"2016-12-08T00:00:00.000Z","date_pretty":"December 8th, 2016","date_from_now":"4 years ago","last_modified_at":"2018-11-16T20:45:16.000Z","last_modified_at_from_now":"2 years ago","path":"/articles/improving-jekyll-static-comments/","author":null,"excerpt":"Using Staticman to add threaded comments and reply notifications to a static-based Jekyll site.","tags":["web development","GitHub","Jekyll","tutorial"],"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7741935483870968,"src":"/static/b3f13c2b29e7f7da8a6813e5500d8882/fc20c/improving-jekyll-static-comments-feature.jpg","srcSet":"/static/b3f13c2b29e7f7da8a6813e5500d8882/6e883/improving-jekyll-static-comments-feature.jpg 275w,\n/static/b3f13c2b29e7f7da8a6813e5500d8882/a09ef/improving-jekyll-static-comments-feature.jpg 550w,\n/static/b3f13c2b29e7f7da8a6813e5500d8882/fc20c/improving-jekyll-static-comments-feature.jpg 1100w,\n/static/b3f13c2b29e7f7da8a6813e5500d8882/9352a/improving-jekyll-static-comments-feature.jpg 1600w","sizes":"(max-width: 1100px) 100vw, 1100px"},"fixed":{"src":"/static/b3f13c2b29e7f7da8a6813e5500d8882/fc20c/improving-jekyll-static-comments-feature.jpg","height":619,"width":1100}}},"toc":true,"comments":true,"comments_locked":true,"hide_meta":null},"id":"beafc95e-a1cb-58b7-8474-bfffa3b71353","html":"<p>In the months after ditching Disqus for a <a href=\"/articles/jekyll-static-comments/\">static-based commenting system</a>, <a href=\"https://staticman.net/\"><strong>Staticman</strong></a> has matured with feature adds like <em>threaded comments</em> and <em>email notifications</em>.</p>\n<p>Armed with instructions provided by Eduardo Bouças in <a href=\"https://github.com/eduardoboucas/staticman/issues/42\" title=\"Email notification upon replies\">this GitHub issue</a>, I set off to level-up the commenting experience on <strong>Made Mistakes</strong>. Here’s how I did it.</p>\n<h2 id=\"upgrade-to-staticman-v2\" style=\"position:relative;\"><a href=\"#upgrade-to-staticman-v2\" aria-label=\"upgrade to staticman v2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Upgrade to Staticman v2</h2>\n<p>To take advantage of the new features, it was necessary to migrate Staticman settings from Jekyll’s <code class=\"language-text\">_config.yml</code> file into a new <code class=\"language-text\">staticman.yml</code> file<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>. None of the parameter names changed making the transition to <code class=\"language-text\">v2</code> that much easier.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">comments</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">allowedFields</span>     <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'email'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'url'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'message'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key atrule\">branch</span>            <span class=\"token punctuation\">:</span> <span class=\"token string\">\"master\"</span>\n  <span class=\"token key atrule\">commitMessage</span>     <span class=\"token punctuation\">:</span> <span class=\"token string\">\"New comment.\"</span>\n  <span class=\"token key atrule\">filename</span>          <span class=\"token punctuation\">:</span> <span class=\"token string\">\"comment-{@timestamp}\"</span>\n  <span class=\"token key atrule\">format</span>            <span class=\"token punctuation\">:</span> <span class=\"token string\">\"yaml\"</span>\n  <span class=\"token key atrule\">moderation</span>        <span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">path</span>              <span class=\"token punctuation\">:</span> <span class=\"token string\">\"src/_data/comments/{options.slug}\"</span>\n  <span class=\"token key atrule\">requiredFields</span>    <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'email'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'message'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key atrule\">transforms</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">email</span>           <span class=\"token punctuation\">:</span> md5\n  <span class=\"token key atrule\">generatedFields</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">date</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">type</span>          <span class=\"token punctuation\">:</span> <span class=\"token string\">\"date\"</span>\n      <span class=\"token key atrule\">options</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">format</span>      <span class=\"token punctuation\">:</span> <span class=\"token string\">\"iso8601\"</span></code></pre></div>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">New configuration options </div><div class=\"custom-block-body\"><p>Be sure to check the <a href=\"https://github.com/eduardoboucas/staticman/blob/master/staticman.sample.yml\">sample configuration file</a> and <a href=\"https://staticman.net/docs/configuration\">full list of parameters</a> for setup ideas.</p><p>For example you can configure multiple properties (comments, reviews, and other types of user-generated content), change commit message and request body text, enable email notifications, and much more from a <code class=\"language-text\">staticman.yml</code> file.</p></div></div>\n<h3 id=\"removeadd-staticman-as-a-collaborator\" style=\"position:relative;\"><a href=\"#removeadd-staticman-as-a-collaborator\" aria-label=\"removeadd staticman as a collaborator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Remove/add Staticman as a collaborator</h3>\n<p>I’m not entirely sure if doing the following was necessary. I encountered errors when submitting test comments and this appeared to solve the problem. It’s possible I mis-configured something else and that was the real issue…</p>\n<p>Either way, let me know about your experience upgrading from Staticman <code class=\"language-text\">v1</code> to <code class=\"language-text\">v2</code> in the comments below.</p>\n<ol>\n<li>Revoked collaboration rights for Staticman <code class=\"language-text\">v1</code> by removing from my GitHub repository.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; background-color: var(--input-background-color); max-width: 1100px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.54545454545454%; position: relative; bottom: 0; left: 0; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"Remove staticmanapp as a collaborator\"\n        title=\"Remove staticmanapp as a collaborator\"\n        data-src=\"/static/edfb6a9ec18d1b507721222f9ac953fe/bad3f/staticman-remove-collaborator.png\"\n        data-srcset=\"/static/edfb6a9ec18d1b507721222f9ac953fe/39133/staticman-remove-collaborator.png 275w,\n/static/edfb6a9ec18d1b507721222f9ac953fe/50322/staticman-remove-collaborator.png 550w,\n/static/edfb6a9ec18d1b507721222f9ac953fe/bad3f/staticman-remove-collaborator.png 1100w,\n/static/edfb6a9ec18d1b507721222f9ac953fe/fe006/staticman-remove-collaborator.png 1114w\"\n        sizes=\"(max-width: 1100px) 100vw, 1100px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></li>\n<li>Added Staticman back as <a href=\"/articles/jekyll-static-comments/#setting-up-staticman\">collaborator</a>.</li>\n<li>Pinged the version 2 endpoint <code class=\"language-text\">https://api.staticman.net/v2/connect/{your GitHub username}/{your repository name}</code> to accept the collaboration invitation.</li>\n</ol>\n<h3 id=\"update-post-endpoint-in-comment-form\" style=\"position:relative;\"><a href=\"#update-post-endpoint-in-comment-form\" aria-label=\"update post endpoint in comment form permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update POST endpoint in comment form</h3>\n<p>To <code class=\"language-text\">POST</code> correctly to Staticman, the <code class=\"language-text\">action</code> attribute in my comment form needed a small update. Changing <code class=\"language-text\">v1</code> to <code class=\"language-text\">v2</code> in <a href=\"https://github.com/mmistakes/made-mistakes-jekyll/blob/f0074b7b9e64b6d4b63dd13a371cedc576dae49d/src/_includes/page__comments.html#L34\"><strong>_includes/page__comments.html</strong></a> and appending <code class=\"language-text\">/comments</code><sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup> to the end did the trick for me.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>page__form js-form form<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://api.staticman.net/v2/entry/{{ site.repository }}/{{ site.staticman.branch }}/comments<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"add-support-for-threaded-comments\" style=\"position:relative;\"><a href=\"#add-support-for-threaded-comments\" aria-label=\"add support for threaded comments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Add support for threaded comments</h2>\n<p>Getting nested comments working was a big pain point for me. Numerous Liquid errors, trying to wrap my head around <code class=\"language-text\">for</code> loops inside of other <code class=\"language-text\">for</code> loops, array filters that broke things, and more — took me a bit to figure out.</p>\n<h3 id=\"add-replying-to-identifier\" style=\"position:relative;\"><a href=\"#add-replying-to-identifier\" aria-label=\"add replying to identifier permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Add “replying to” identifier</h3>\n<p>To properly nest replies I needed a way of determining their hierarchy. I went with a field named <code class=\"language-text\">replying_to</code> and added it as an <code class=\"language-text\">allowedField</code> to my Staticman config file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">allowedFields</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"email\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"replying_to\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>And to my comment form as a hidden field:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-parent<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[replying_to]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">Update: field name change </div><div class=\"custom-block-body\"><p>After publishing this article I learned that <a href=\"https://github.com/eduardoboucas/staticman/issues/42#issuecomment-262938831\"><code class=\"language-text\">options[parent]</code></a> is meant to identify subscription entries, and not comment lineage. I’ve since changed to <code class=\"language-text\">fields[replying_to]</code> and updated the article and sample code to reflect this.</p></div></div>\n<h3 id=\"update-liquid-loops\" style=\"position:relative;\"><a href=\"#update-liquid-loops\" aria-label=\"update liquid loops permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update Liquid loops</h3>\n<p>To avoid displaying duplicates, I needed to exclude replies and only top level comments in the main loop. This seemed like the perfect use-case for Jekyll’s <code class=\"language-text\">where_exp</code> filter:</p>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">Where expression Jekyll filter</div><div class=\"custom-block-body\"><p>Select all the objects in an array where the expression is true. Jekyll v3.2.0 &#x26; later. <strong>Example:</strong> <code class=\"language-text\">site.members | where_exp: &quot;item&quot;, &quot;item.graduation_year == 2014&quot;</code></p></div></div>\n<p>If the hidden <code class=\"language-text\">fields[replying_to]</code> field I added to the form was working properly I should have comment data files similar to these:</p>\n<h4 id=\"parent-comment-example\" style=\"position:relative;\"><a href=\"#parent-comment-example\" aria-label=\"parent comment example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parent comment example</h4>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">message</span><span class=\"token punctuation\">:</span> This is parent comment message.\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> First LastName\n<span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> md5g1bb3r15h\n<span class=\"token key atrule\">date</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2016-11-30T22:03:15.286Z'</span></code></pre></div>\n<h4 id=\"child-comment-example\" style=\"position:relative;\"><a href=\"#child-comment-example\" aria-label=\"child comment example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Child comment example</h4>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">message</span><span class=\"token punctuation\">:</span> This is a child comment message.\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> First LastName\n<span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> md5g1bb3r15h\n<span class=\"token key atrule\">replying_to</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'7'</span>\n<span class=\"token key atrule\">date</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2016-11-02T05:08:43.280Z'</span></code></pre></div>\n<p>As you can see above, the “child” comment has <code class=\"language-text\">replying_to</code> data populated from the hidden <code class=\"language-text\">fields[replying_to]</code> field in the form. Using this knowledge I tested against it using <code class=\"language-text\">where_exp:&quot;comment&quot;, &quot;comment.replying_to == blank&quot;</code> to create an array of only “top-level” comments.</p>\n<div class=\"gatsby-highlight\" data-language=\"liquid\"><pre class=\"language-liquid\"><code class=\"language-liquid\">{<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> comments <span class=\"token operator\">=</span> site.data.comments[page.slug] <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token operator\">|</span> where_exp<span class=\"token operator\">:</span> \"<span class=\"token keyword\">comment</span>\", \"<span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].replying_to <span class=\"token operator\">==</span> blank\" <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">for</span> <span class=\"token keyword\">comment</span> <span class=\"token keyword\">in</span> comments <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> avatar      <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].avatar <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> email       <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].email <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> name        <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].name <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> url         <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].url <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> <span class=\"token function\">date</span>        <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].date <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> message     <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].message <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token function\">include</span> <span class=\"token keyword\">comment</span>.html avatar<span class=\"token operator\">=</span>avatar email<span class=\"token operator\">=</span>email name<span class=\"token operator\">=</span>name url<span class=\"token operator\">=</span>url <span class=\"token function\">date</span><span class=\"token operator\">=</span><span class=\"token function\">date</span> message<span class=\"token operator\">=</span>message <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">endfor</span> <span class=\"token operator\">%</span>}</code></pre></div>\n<figure>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; background-color: var(--input-background-color); max-width: 980px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 81.0909090909091%; position: relative; bottom: 0; left: 0; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image lazyload\" alt=\"Example of parent comments\" title=\"Example of parent comments\" data-src=\"/static/d58de0d27a4b2356cf37ca1a51b54be1/26e05/staticman-parent-comments-only.png\" data-srcset=\"/static/d58de0d27a4b2356cf37ca1a51b54be1/39133/staticman-parent-comments-only.png 275w,\n/static/d58de0d27a4b2356cf37ca1a51b54be1/50322/staticman-parent-comments-only.png 550w,\n/static/d58de0d27a4b2356cf37ca1a51b54be1/26e05/staticman-parent-comments-only.png 980w\" sizes=\"(max-width: 980px) 100vw, 980px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <figcaption><p>Success, there be parent comments Captain!</p></figcaption>\n</figure>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">Note: <code class=\"language-text\">sort</code> and <code class=\"language-text\">where</code> filters don’t mix</div><div class=\"custom-block-body\"><p>I ran into strange behaviors and errors due to mixing a <code class=\"language-text\">sort</code> filter with <code class=\"language-text\">where</code> and <code class=\"language-text\">where_exp</code>. Came to the conclusion it was unnecessary as the items were already being sorted alphabetically based on their filenames, and removed the filter.</p><p>I’m using the following: <code class=\"language-text\">filename: \\&quot;comment-{@timestamp}\\&quot;</code> structure. Your mileage may vary depending on how you name entries.</p></div></div>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">Note: added back <code class=\"language-text\">sort</code> filter</div><div class=\"custom-block-body\"><p>Not exactly sure if it’s a filesystem or OS thing, but building my site with Travis CI shuffled the order of comments. Applying <code class=\"language-text\">sort</code> to the <code class=\"language-text\">comments</code> assign was necessary to get everything in the correct chronological order.</p></div></div>\n<h4 id=\"displaying-nested-comments\" style=\"position:relative;\"><a href=\"#displaying-nested-comments\" aria-label=\"displaying nested comments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Displaying nested comments</h4>\n<p>Here is what I was looking to accomplish… before the headaches started.</p>\n<ul>\n<li>Start a loop and on each iteration create a new array named <code class=\"language-text\">replies</code> of only reply comments.</li>\n<li>Evaluate the value of <code class=\"language-text\">replying_to</code> in these replies.</li>\n<li>If <code class=\"language-text\">replying_to</code> is equal to the index of the parent loop then it’s a child and should be treated as one.</li>\n<li>If not, move on to the next entry in the array.</li>\n<li>Rinse and repeat.</li>\n</ul>\n<p>I determined the easiest way of assigning a unique identifier to each parent comment would be sequentially. Thankfully Liquid provides a way of doing this with <code class=\"language-text\">forloop.index</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"liquid\"><pre class=\"language-liquid\"><code class=\"language-liquid\">{<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> index <span class=\"token operator\">=</span> forloop.index <span class=\"token operator\">%</span>}</code></pre></div>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">Universally unique identifier</div><div class=\"custom-block-body\"><p>I realize an index based unique identifier isn’t the smartest way to go about this. I have a mix of comment data migrated from Disqus and pre Staticman generating UUIDs as <code class=\"language-text\">_id</code> variables, so this made sense. <abbr title=\"Your mileage may vary\">YMMV</abbr>.</p></div></div>\n<p>Next I nested a modified copy of the “top-level comment” loop from before inside of itself — to function as the “child” or <code class=\"language-text\">replies</code> loop.</p>\n<div class=\"gatsby-highlight\" data-language=\"liquid\"><pre class=\"language-liquid\"><code class=\"language-liquid\">{<span class=\"token operator\">%</span> <span class=\"token keyword\">capture</span> i <span class=\"token operator\">%</span>}{{ include.index }}{<span class=\"token operator\">%</span> <span class=\"token keyword\">endcapture</span> <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> replies <span class=\"token operator\">=</span> site.data.comments[page.slug] <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token operator\">|</span> where_exp<span class=\"token operator\">:</span> \"<span class=\"token keyword\">comment</span>\", \"<span class=\"token keyword\">comment</span>[<span class=\"token number\">1</span>].replying_to <span class=\"token operator\">==</span> i\" <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">for</span> reply <span class=\"token keyword\">in</span> replies <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> index       <span class=\"token operator\">=</span> forloop.index <span class=\"token operator\">|</span> <span class=\"token function\">prepend</span><span class=\"token operator\">:</span> '<span class=\"token operator\">-</span>' <span class=\"token operator\">|</span> <span class=\"token function\">prepend</span><span class=\"token operator\">:</span> include.index <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> replying_to <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].replying_to <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> avatar      <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].avatar <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> email       <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].email <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> name        <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].name <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> url         <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].url <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> <span class=\"token function\">date</span>        <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].date <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> message     <span class=\"token operator\">=</span> reply[<span class=\"token number\">1</span>].message <span class=\"token operator\">%</span>}\n  {<span class=\"token operator\">%</span> <span class=\"token function\">include</span> <span class=\"token keyword\">comment</span>.html index<span class=\"token operator\">=</span>index replying_to<span class=\"token operator\">=</span>replying_to avatar<span class=\"token operator\">=</span>avatar email<span class=\"token operator\">=</span>email name<span class=\"token operator\">=</span>name url<span class=\"token operator\">=</span>url <span class=\"token function\">date</span><span class=\"token operator\">=</span><span class=\"token function\">date</span> message<span class=\"token operator\">=</span>message <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">endfor</span> <span class=\"token operator\">%</span>}</code></pre></div>\n<p>Unfortunately the <code class=\"language-text\">where_exp</code> filter proved troublesome yet again, causing Jekyll to error out with: <code class=\"language-text\">Liquid Exception: Liquid error (line 47): Nesting too deep in /_layouts/page.html</code>.</p>\n<p>After brief thoughts of the movie <strong>Inception</strong>, I applied an <code class=\"language-text\">inspect</code> filter to help troubleshoot the <code class=\"language-text\">replies</code> loop. I determined that the <code class=\"language-text\">where_exp</code> condition was failing<sup id=\"fnref-3\"><a href=\"#fn-3\" class=\"footnote-ref\">3</a></sup> because I was trying to compare an integer against a string.</p>\n<p>To solve this I placed a <code class=\"language-text\">capture</code> tag around the index variable to convert it from an integer into a string. Then modified the <code class=\"language-text\">where_exp</code> condition to compare <code class=\"language-text\">replying_to</code> against this new <code class=\"language-text\">{{ i }}</code> variable — fixing the issue and allowing me to move on.</p>\n<div class=\"gatsby-highlight\" data-language=\"liquid\"><pre class=\"language-liquid\"><code class=\"language-liquid\">{<span class=\"token operator\">%</span> <span class=\"token keyword\">capture</span> i <span class=\"token operator\">%</span>}{{ include.index }}{<span class=\"token operator\">%</span> <span class=\"token keyword\">endcapture</span> <span class=\"token operator\">%</span>}\n{<span class=\"token operator\">%</span> <span class=\"token keyword\">assign</span> replies <span class=\"token operator\">=</span> site.data.comments[page.slug] <span class=\"token operator\">|</span> where_exp<span class=\"token operator\">:</span>\"item\", \"item.replying_to <span class=\"token operator\">==</span> i\" <span class=\"token operator\">%</span>}</code></pre></div>\n<h4 id=\"_includespage__commentshtml\" style=\"position:relative;\"><a href=\"#_includespage__commentshtml\" aria-label=\"_includespage__commentshtml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">_includes/page__comments.html</code></h4>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>page__reactions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  {% if site.repository and site.staticman.branch %}\n    {% if site.data.comments[page.slug] %}\n      <span class=\"token comment\">&lt;!-- Start static comments --></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comments<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>js-comments<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>page__section-label<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          {% if site.data.comments[page.slug].size > 1 %}\n            {{ site.data.comments[page.slug] | size }}\n          {% endif %}\n          Comments\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n        {% assign comments = site.data.comments[page.slug] | sort | where_exp: 'comment', 'comment[1].replying_to == blank' %}\n        {% for comment in comments %}\n          {% assign index       = forloop.index %}\n          {% assign replying_to = comment[1].replying_to | to_integer %}\n          {% assign avatar      = comment[1].avatar %}\n          {% assign email       = comment[1].email %}\n          {% assign name        = comment[1].name %}\n          {% assign url         = comment[1].url %}\n          {% assign date        = comment[1].date %}\n          {% assign message     = comment[1].message %}\n          {% include comment.html index=index replying_to=replying_to avatar=avatar email=email name=name url=url date=date message=message %}\n        {% endfor %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token comment\">&lt;!-- End static comments --></span>\n    {% endif %}\n\n    {% unless page.comments_locked == true %}\n      <span class=\"token comment\">&lt;!-- Start new comment form --></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>respond<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>page__section-label<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Leave a Comment <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>small</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>nofollow<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>cancel-comment-reply-link<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.url | absolute_url }}#respond<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span>none<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Cancel reply<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>small</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>page__form js-form form<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://api.staticman.net/v2/entry/{{ site.repository }}/{{ site.staticman.branch }}/comments<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-message<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Comment<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>small</span><span class=\"token punctuation\">></span></span>(<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://kramdown.gettalong.org/quickref.html<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Markdown<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span> is allowed)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>small</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rows</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>6<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-message<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[message]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">required</span> <span class=\"token attr-name\">spellcheck</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[name]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">required</span> <span class=\"token attr-name\">spellcheck</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-email<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Email<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>small</span><span class=\"token punctuation\">></span></span>(used for <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://gravatar.com<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Gravatar<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span> image and reply notifications)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>small</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[email]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">required</span> <span class=\"token attr-name\">spellcheck</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-url<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Website<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>small</span><span class=\"token punctuation\">></span></span>(optional)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>small</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-url<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[url]<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[origin]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.url | absolute_url }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[parent]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.url | absolute_url }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-replying-to<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[replying_to]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-post-id<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[slug]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.slug }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-location<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Leave blank if you are a human<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-location<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fields[hidden]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">autocomplete</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>off<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token comment\">&lt;!-- Start comment form alert messaging --></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden js-notice<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>js-notice-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token comment\">&lt;!-- End comment form alert messaging --></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-reply<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-reply<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[subscribe]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n              Notify me of replies by email.\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn btn--large<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Submit Comment<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token comment\">&lt;!-- End new comment form --></span>\n    {% else %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>em</span><span class=\"token punctuation\">></span></span>Comments are closed. If you have a question concerning the content of this page, please feel free to <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/contact/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>contact me<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>em</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n    {% endunless %}\n  {% endif %}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h4 id=\"_includescommenthtml\" style=\"position:relative;\"><a href=\"#_includescommenthtml\" aria-label=\"_includescommenthtml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">_includes/comment.html</code></h4>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>article</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment{% unless include.r %}{{ index | prepend: '-' }}{% else %}{{ include.index | prepend: '-' }}{% endunless %}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>js-comment comment {% if include.name == site.author.name %}admin{% endif %} {% unless include.replying_to == 0 %}child{% endunless %}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__avatar<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% if include.avatar %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.avatar }}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.name | escape }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% elsif include.email %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://www.gravatar.com/avatar/{{ include.email }}?d=mm&amp;s=60<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://www.gravatar.com/avatar/{{ include.email }}?d=mm&amp;s=120 2x<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.name | escape }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% else %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/assets/images/avatar-60.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/assets/images/avatar-120.png 2x<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.name | escape }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% endif %}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__author-name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% unless include.url == blank %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>external nofollow<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.url }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        {% if include.name == site.author.name %}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>20px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>20px<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>use</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#icon-mistake<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>use</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span> {% endif %}{{ include.name }}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    {% else %}\n      {% if include.name == site.author.name %}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>20px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>20px<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>use</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#icon-mistake<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>use</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span> {% endif %}{{ include.name }}\n    {% endunless %}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__timestamp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {% if include.date %}\n      {% if include.index %}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#comment{% if r %}{{ index | prepend: '-' }}{% else %}{{ include.index | prepend: '-' }}{% endif %}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>path to this comment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{% endif %}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>time</span> <span class=\"token attr-name\">datetime</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ include.date | date_to_xmlschema }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{ include.date | date: '%B %d, %Y' }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>time</span><span class=\"token punctuation\">></span></span>\n      {% if include.index %}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>{% endif %}\n    {% endif %}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    {{ include.message | markdownify }}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  {% unless include.replying_to != 0 or page.comments_locked == true %}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__reply<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>nofollow<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#comment-{{ include.index }}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>return addComment.moveForm('comment-{{ include.index }}', '{{ include.index }}', 'respond', '{{ page.slug }}')<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Reply to {{ include.name }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  {% endunless %}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>article</span><span class=\"token punctuation\">></span></span>\n\n{% capture i %}{{ include.index }}{% endcapture %}\n{% assign replies = site.data.comments[page.slug] | sort | where_exp: 'comment', 'comment[1].replying_to == i' %}\n{% for reply in replies %}\n  {% assign index       = forloop.index | prepend: '-' | prepend: include.index %}\n  {% assign replying_to = reply[1].replying_to | to_integer %}\n  {% assign avatar      = reply[1].avatar %}\n  {% assign email       = reply[1].email %}\n  {% assign name        = reply[1].name %}\n  {% assign url         = reply[1].url %}\n  {% assign date        = reply[1].date %}\n  {% assign message     = reply[1].message %}\n  {% include comment.html index=index replying_to=replying_to avatar=avatar email=email name=name url=url date=date message=message %}\n{% endfor %}</code></pre></div>\n<h3 id=\"comment-reply-html-and-javascript\" style=\"position:relative;\"><a href=\"#comment-reply-html-and-javascript\" aria-label=\"comment reply html and javascript permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Comment reply HTML and JavaScript</h3>\n<p>Next up was to add some finishing touches to pull everything together.</p>\n<p>Familiar with the way <a href=\"https://wordpress.org/\"><strong>Wordpress</strong></a> handles reply forms I looked to it for inspiration. Digging through the JavaScript in <a href=\"https://core.svn.wordpress.org/trunk/wp-includes/js/comment-reply.js\"><code class=\"language-text\">wp-includes/js/comment-reply.js</code></a> I found everything I could possibly need:</p>\n<ul>\n<li><code class=\"language-text\">respond</code> function to move form into view</li>\n<li><code class=\"language-text\">cancel</code> function to destroy a reply form a return it to its original state</li>\n<li>pass parent’s unique identifier to <code class=\"language-text\">fields[replying_to]</code> on form submit</li>\n</ul>\n<p>To start I used an <code class=\"language-text\">unless</code> condition to only show reply links on “top-level” comments. I only planned on going one-level deep with replies, so this seemed like a good way of enforcing that.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">{% unless r %}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment__reply<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>nofollow<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#comment-{{ include.index }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Reply to {{ include.name }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n{% endunless %}</code></pre></div>\n<figure>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; background-color: var(--input-background-color); max-width: 981px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 96.72727272727273%; position: relative; bottom: 0; left: 0; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image lazyload\" alt=\"Nested comments\" title=\"Nested comments\" data-src=\"/static/512a888dbc18e75c85a4a404c944fb62/17462/staticman-nested-comments.png\" data-srcset=\"/static/512a888dbc18e75c85a4a404c944fb62/39133/staticman-nested-comments.png 275w,\n/static/512a888dbc18e75c85a4a404c944fb62/50322/staticman-nested-comments.png 550w,\n/static/512a888dbc18e75c85a4a404c944fb62/17462/staticman-nested-comments.png 981w\" sizes=\"(max-width: 981px) 100vw, 981px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <figcaption><p>Nested comments one-level deep.</p></figcaption>\n  </figure>\n<p>To give the <strong>reply link</strong> life I added the following <code class=\"language-text\">onclick</code> attribute and <a href=\"https://github.com/mmistakes/made-mistakes-jekyll/blob/49632d19977e341b51c91dad8e71bf6ef88e79c3/src/assets/javascripts/main.js#L84-L181\">JavaScript</a> to it.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">onclick<span class=\"token operator\">=</span><span class=\"token string\">\"return addComment.moveForm('comment-{{ include.index }}', '{{ include.index }}', 'respond', '{{ page.slug }}')\"</span></code></pre></div>\n<p>A few minor variable name changes to Wordpress’ <code class=\"language-text\">comment-reply.js</code> script was all it took to get everything working with my <code class=\"language-text\">form</code> markup.</p>\n<p><img src=\"/e6882ac44d96d3cfa98c7ca4872dbe75/comment-reply-animation.gif\" alt=\"Comment replies in action\"></p>\n<p>Hitting a <strong>reply button</strong> moves the comment form into view and populates <code class=\"language-text\">&lt;input type=&#39;hidden&#39; id=&#39;comment-replying-to&#39; name=&#39;fields[replying_to]&#39; value=&#39;&#39;&gt;</code> with the correct <em>parent</em> <code class=\"language-text\">value</code>. While tapping <strong>Cancel reply</strong> returns the input to its original state of <code class=\"language-text\">null</code>.</p>\n<h2 id=\"add-support-for-email-notifications\" style=\"position:relative;\"><a href=\"#add-support-for-email-notifications\" aria-label=\"add support for email notifications permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Add support for email notifications</h2>\n<p>Compared to nesting comment replies, email notifications were a breeze to setup.</p>\n<h3 id=\"update-staticmanyml-configuration\" style=\"position:relative;\"><a href=\"#update-staticmanyml-configuration\" aria-label=\"update staticmanyml configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update <code class=\"language-text\">staticman.yml</code> configuration</h3>\n<p>To ensure that links in notification emails are safe and only come from trusted domains, set <code class=\"language-text\">allowedOrigins</code> accordingly. </p>\n<p><strong>Example:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">allowedOrigins</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"mademistakes.com\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>The domain(s) allowed here must match those passed from an <code class=\"language-text\">options.origin</code> field we’re going to add in the next step. Only domains that match will trigger notifications to send, otherwise the operation will abort.</p>\n<div class=\"custom-block notice\"><div class=\"custom-block-heading\">ProTip: use your own Mailgun account</div><div class=\"custom-block-body\"><p>The public instance of Staticman uses a <a href=\"http://www.mailgun.com/\"><strong>Mailgun</strong></a> account with a limit of 10,000 emails a month. You are encouraged to create an account and add your own <a href=\"https://staticman.net/docs/configuration#notifications.enabled\">Mailgun API and domain</a> to <code class=\"language-text\">staticman.yml</code>. Be sure you encrypt both using the following endpoint: <code class=\"language-text\">https://api.staticman.net/v2/encrypt/{TEXT TO BE ENCRYPTED}</code>.</p></div></div>\n<h3 id=\"update-comment-form\" style=\"position:relative;\"><a href=\"#update-comment-form\" aria-label=\"update comment form permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update comment form</h3>\n<p>To finish, add the following three fields to the comment <code class=\"language-text\">form</code>. </p>\n<p><strong>Field 1 + 2:</strong> Hidden input fields that pass the <code class=\"language-text\">origin</code><sup id=\"fnref-4\"><a href=\"#fn-4\" class=\"footnote-ref\">4</a></sup> set in <code class=\"language-text\">staticman.yml</code> and unique identifier to the entry the user is subscriber to:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[origin]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.url | absolute_url }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[parent]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ page.url | absolute_url }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><strong>Field 3:</strong> A checkbox <code class=\"language-text\">input</code> for subscribing to email notifications.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-reply<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>comment-form-reply<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>options[subscribe]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  Notify me of new comments by email.\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Nothing fancy here, <code class=\"language-text\">name=options[subscribe]</code> and <code class=\"language-text\">value=&quot;email&quot;</code> are added to the field to associate subscription data with email address.</p>\n<p>If setup correctly a user should receive an email anytime a new comment on the post or page they subscribed to is merged in.</p>\n<p>Example of a Staticman <strong>New reply</strong> email notification:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; background-color: var(--input-background-color); max-width: 1100px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.18181818181818%; position: relative; bottom: 0; left: 0; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"Staticman reply email notification\"\n        title=\"Staticman reply email notification\"\n        data-src=\"/static/0b3e2f77d709c1514da8240a2928cfec/bad3f/staticman-email-notification.png\"\n        data-srcset=\"/static/0b3e2f77d709c1514da8240a2928cfec/39133/staticman-email-notification.png 275w,\n/static/0b3e2f77d709c1514da8240a2928cfec/50322/staticman-email-notification.png 550w,\n/static/0b3e2f77d709c1514da8240a2928cfec/bad3f/staticman-email-notification.png 1100w,\n/static/0b3e2f77d709c1514da8240a2928cfec/3447d/staticman-email-notification.png 1124w\"\n        sizes=\"(max-width: 1100px) 100vw, 1100px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<hr>\n<p>Well there you have it, a static-based commenting system done up in Jekyll that handles nested comments and reply notifications. Now if I could only shave a minute of my build time to get new comments merged in quicker.</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>An added benefit of the new configuration file means you can use Staticman with other static site generators. <code class=\"language-text\">v2</code> no longer requires you to use a Jekyll specific <code class=\"language-text\">_config.yml</code> file.</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>Site properties are optional. See Staticman documentation for details on <a href=\"https://staticman.net/docs/#step-3-hook-up-your-forms\">hooking up your forms</a>.</p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-3\">\n<p><code class=\"language-text\">15</code> is not the same as <code class=\"language-text\">&#39;15&#39;</code>. Those single quotes make a world of difference…</p>\n<a href=\"#fnref-3\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-4\">\n<p>This URL will be included in the notification email sent to subscribers, allowing them to open the page directly.</p>\n<a href=\"#fnref-4\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>","excerpt":"In the months after ditching Disqus for a static-based commenting system, Staticman has matured with feature adds like threaded comments and…","timeToRead":15,"tableOfContents":"<ul>\n<li>\n<p><a href=\"/articles/improving-jekyll-static-comments/#upgrade-to-staticman-v2\">Upgrade to Staticman v2</a></p>\n<ul>\n<li><a href=\"/articles/improving-jekyll-static-comments/#removeadd-staticman-as-a-collaborator\">Remove/add Staticman as a collaborator</a></li>\n<li><a href=\"/articles/improving-jekyll-static-comments/#update-post-endpoint-in-comment-form\">Update POST endpoint in comment form</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/articles/improving-jekyll-static-comments/#add-support-for-threaded-comments\">Add support for threaded comments</a></p>\n<ul>\n<li><a href=\"/articles/improving-jekyll-static-comments/#add-replying-to-identifier\">Add “replying to” identifier</a></li>\n<li><a href=\"/articles/improving-jekyll-static-comments/#update-liquid-loops\">Update Liquid loops</a></li>\n<li><a href=\"/articles/improving-jekyll-static-comments/#comment-reply-html-and-javascript\">Comment reply HTML and JavaScript</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/articles/improving-jekyll-static-comments/#add-support-for-email-notifications\">Add support for email notifications</a></p>\n<ul>\n<li><a href=\"/articles/improving-jekyll-static-comments/#update-staticmanyml-configuration\">Update <code class=\"language-text\">staticman.yml</code> configuration</a></li>\n<li><a href=\"/articles/improving-jekyll-static-comments/#update-comment-form\">Update comment form</a></li>\n</ul>\n</li>\n</ul>"},"comments":{"edges":[{"node":{"id":"a968ee5d-07bf-5f86-83c4-00970f116976","frontmatter":{"name":"Arnab Wahid","email":"2b5f4253acf477e13cea08554f070fef","friendlyDate":"December 11, 2016","iso8601Date":"2016-12-11T12:54:44.455Z","published":null},"html":"<p>Thanks for writing the steps in such details. I think yours is the only blog\nthat has been laying out the details of using <strong>Staticman</strong> as the experience\nthat followed.</p>\n<p>Your website is one of the most, if not the most articulate example of web\ndesign I have come across, both aesthetically and technically. You are always\nconstantly redesigning and improving this site, playing with cutting edge tech.\nI can only imagine what else happens before generating the site. :)</p>\n<p><strong>How much time do you spend coding this site on average?</strong> If you do not mind\nme asking of course. I am asking because I am currently scared of the level of\ncommitment that is required to treat your website as a piece of art…</p>\n<p><em>This comment became so lengthy that I emailed you the rest.</em></p>"}},{"node":{"id":"8902cdcc-7e9d-5fde-94c6-451d76a60ef2","frontmatter":{"name":"Jared White","email":"c3251b8885318878b80fa28467944879","friendlyDate":"December 11, 2016","iso8601Date":"2016-12-11T16:38:59.049Z","published":null},"html":"<p>Wow, this looks amazing! I’m definitely going to check it out…I’ll be\nlaunching a new Jekyll-powered magazine soon and have considered comments but I\ndefinitely want to avoid Disqus if possible.</p>"}},{"node":{"id":"f5f95b06-8bde-5e74-95ac-4cbc21d31176","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"December 11, 2016","iso8601Date":"2016-12-11T18:05:33.341Z","published":null},"html":"<p>If you added up all the time I’ve spent on the site over the years it’s probably\na 💩 ton! Writing articles definitely eats up most of the time. It takes me\nforever to write even the simplest post… which is why I don’t post all that\noften.</p>\n<p>Articles of this length tend to take me 5–20 hours to produce over the course\nof a week or two. Just from all the distractions and other commitments in my\nlife… can be hard to focus on a single thing at once.</p>\n<p>The design and layout stuff comes much faster. I’m constantly making small\nadjustments as I experiment with new things. I don’t get too hung up if I break\nsomething here, it’s one big learning experience for me.</p>"}},{"node":{"id":"4de021a9-c4d5-5a26-9da1-8a0826133afc","frontmatter":{"name":"Zoltan Burgermeiszter","email":"183cace68094ae879629ba4840b13c56","friendlyDate":"December 13, 2016","iso8601Date":"2016-12-13T10:15:26.577Z","published":null},"html":"<p>To speed up the build time I used a Docker image in Travis. With this I don’t\nhave to wait for the installation of all Jekyll dependencies.</p>\n<p>The size is WIP but you can get some ideas from my\n<a href=\"https://github.com/zburgermeiszter/blog.burgermeiszter.com/blob/master/.travis.yml\">Travis config, and Dockerfile</a>.</p>"}},{"node":{"id":"637eefcd-8039-54ce-a49a-d9e1851fabef","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"December 13, 2016","iso8601Date":"2016-12-13T19:41:30.051Z","published":null},"html":"<p>How many posts do you have? Having close to 1,000 posts I’ve found they bog\nthings down way more than installing dependencies ever could.</p>\n<p>Found\n<a href=\"http://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html\">this article</a>\nthat introduced me to the idea of having Jekyll do less and use\n<a href=\"http://gulpjs.com/\">Gulp</a> to do some of the heavy lifting (preprocessing Sass,\nconcatenating/minifying JS, optimizing images, minifying HTML, etc.) instead</p>\n<p>Was able to\n<a href=\"https://github.com/mmistakes/made-mistakes-jekyll/issues/49\">shave a few minutes off the build time</a>\ndoing just that. It complicates the build process slightly but has the advantage\nof not being as reliant on Jekyll — if I ever decide to switch to a different\nstatic site generator.</p>"}},{"node":{"id":"08b8eb4c-65c3-5c6e-9504-fd31276a5104","frontmatter":{"name":"Domantas","email":"cbd841d40a5279069359827a9b3f9fd6","friendlyDate":"December 14, 2016","iso8601Date":"2016-12-14T16:06:01.640Z","published":null},"html":"<p>Thank you for this article. It’s awesome, I have successfully added static\ncomments to jekyll. I noticed that you do not use Akismet. Is there any reason\nfor this?</p>"}},{"node":{"id":"30a8beff-5e0b-5fc4-a1de-8f3508ed0a7b","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"December 14, 2016","iso8601Date":"2016-12-14T18:59:30.845Z","published":null},"html":"<p>I tried enabling Akismet with the following but it never quite worked:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">akismet</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">author</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"name\"</span>\n    <span class=\"token key atrule\">authorEmail</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"email\"</span>\n    <span class=\"token key atrule\">authorUrl</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"url\"</span>\n    <span class=\"token key atrule\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"message\"</span>\n    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"comment\"</span></code></pre></div>\n<p>Were you able to get it working?</p>\n<p>From this\n<a href=\"https://staticman.net/docs/configuration#akismet.enabled\">line in Staticman’s documenation</a>\nI got the feeling the public instance of Staticman needed it setup. Wasn’t sure\nif that was the case or if it was only for those running their own instances of\nthe app.</p>\n<blockquote>\n<p><strong>akismet.enabled</strong> Whether to use Akismet to check entries for spam. This\nrequires an Akismet account to be configured in the Staticman API instance\nbeing used.</p>\n</blockquote>"}},{"node":{"id":"3be73267-54dd-520c-8942-303cf5dca189","frontmatter":{"name":"Doug Langille","email":"a12cc667f733ace5a90e6c3e961a9d79","friendlyDate":"January 11, 2017","iso8601Date":"2017-01-11T02:56:30.667Z","published":null},"html":"<p>Hi Michael.</p>\n<p>Any chance you’re going to update minimal-mistakes to support the new staticman\nfeatures like threading and reply notification? You’re Jekyll-fu is stronger\nthan mine.</p>"}},{"node":{"id":"f34fecb3-2401-5348-a936-a53091cb1e14","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"January 11, 2017","iso8601Date":"2017-01-11T03:24:50.367Z","published":null},"html":"<p>I’d like to. Just need to give it some thought so I can come up with a way to\nsupport the new stuff in Staticman while maintaining backwards compatibility.</p>\n<p>There are some changes needed to use v2 which could break things for those who\ndon’t update to the new <code class=\"language-text\">staticman.yml</code> config.</p>"}},{"node":{"id":"b646f146-42cd-5ce2-865f-ef71e35ba7f9","frontmatter":{"name":"Justin Rummel","email":"812849b04c44245ad29c0e40cb84e3da","friendlyDate":"January 24, 2017","iso8601Date":"2017-01-24T01:33:05.966Z","published":null},"html":"<p>I have a hosting provider for my site and Looking to migrate from Disqus. Is a\nGitHub repo required? Can this be setup using Minimal Mistakes and not on GitHub\nPages?</p>"}},{"node":{"id":"f976c907-fa19-50d9-89a8-3a3c0757e6f9","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"January 24, 2017","iso8601Date":"2017-01-24T13:02:59.771Z","published":null},"html":"<p>Yes a GitHub repo is required for <a href=\"https://staticman.net/docs/\">Staticman</a> to\nwork. It needs collaboration access to the repo to create pull requests against\nit to add the comment <code class=\"language-text\">_data</code> files. You don’t have to host your site with\nGitHub Pages though.</p>\n<p>I host with Media Temple but have my repo on GH. The workflow goes something\nlike: new comment submitted > Staticman creates a pull request to add to site’s\nrepo > merge pull request > re-build site > deploy.</p>\n<p>Depending on how you deploy your site some of this may vary slightly. Previously\nI was building locally each time I merged in a new comment then rsync’d the\ncontents of <code class=\"language-text\">_site</code> to my hosting. Now I use <a href=\"https://travis-ci.org/\">Travis CI</a>\nto build my site after merges and it handles the deployments automatically.</p>"}},{"node":{"id":"add7435c-be84-5d3c-b5b3-9fc28db4bddb","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"January 24, 2017","iso8601Date":"2017-01-24T13:05:02.751Z","published":null},"html":"<p>And yes, Minimal Mistakes\n<a href=\"https://mmistakes.github.io/minimal-mistakes/docs/configuration/#static-based-comments-via-staticman\">supports Staticman comments</a>.\nI haven’t updated it to support <code class=\"language-text\">v2</code> that can handle replies and comment\nnotifications. But that shouldn’t be too hard for you to tackle if you follow\nwhat I did in this post.</p>"}},{"node":{"id":"26d0e1ab-9be3-557d-b37b-15232569adac","frontmatter":{"name":"Justin Rummel","email":"812849b04c44245ad29c0e40cb84e3da","friendlyDate":"January 27, 2017","iso8601Date":"2017-01-27T21:03:05.999Z","published":null},"html":"<p>I now have Travis configured. I can display old Disqus comments, now to figure\nout how to post comments!</p>"}},{"node":{"id":"be6d2b61-b259-5035-8975-a52869c1ab73","frontmatter":{"name":"Justin Rummel","email":"812849b04c44245ad29c0e40cb84e3da","friendlyDate":"January 30, 2017","iso8601Date":"2017-01-30T11:38:26.403Z","published":null},"html":"<p>Success. I now have parent/child comments using Staticman v2 and Travis.</p>\n<p>Last step is the Mailgun integration.</p>\n<p>Public Test URL: <a href=\"https://www.justinrummel.com/macworld-2010-pictures/\">https://www.justinrummel.com/macworld-2010-pictures/</a></p>"}},{"node":{"id":"cf95cce3-d111-5266-b71a-d0a81b136f11","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"January 30, 2017","iso8601Date":"2017-01-30T21:44:40.011Z","published":null},"html":"<p>Nice! FYI when I hit your site I’m getting warnings in Chrome related to SSL.\nNot sure if something is up with your certificate or what.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Your connection is not private\nAttackers might be trying to steal your information from www.justinrummel.com (for example, passwords, messages, or credit cards).\nNET::ERR_SSL_PINNED_KEY_NOT_IN_CERT_CHAIN</code></pre></div>"}},{"node":{"id":"6af8f412-3833-555f-8a6d-f2322f7f0dcf","frontmatter":{"name":"David Jones","email":"14a298db4912733411bb8d3067b478bc","friendlyDate":"February 01, 2017","iso8601Date":"2017-02-01T22:55:40.666Z","published":null},"html":"<p>I have been trying to update my copy of Minimal Mistakes with this. I have it\nalmost working but the jQuery. How do you get the function to hook into the form\nso it does not redirect the user?</p>"}},{"node":{"id":"54cd1813-6ffc-50d9-b641-81a6bdee04d5","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"February 02, 2017","iso8601Date":"2017-02-02T00:31:58.222Z","published":null},"html":"<p>Have a look at <a href=\"https://github.com/justinrummel/jr.com-mm\">Justin’s repo</a>. He\nhas Staticman <code class=\"language-text\">v2</code> working with Minimal Mistakes.</p>"}},{"node":{"id":"c69a0e60-178c-5578-95c6-42b4d7c1ab45","frontmatter":{"name":"David Jones","email":"14a298db4912733411bb8d3067b478bc","friendlyDate":"February 02, 2017","iso8601Date":"2017-02-02T17:28:40.228Z","published":null},"html":"<p>Thanks, I got it working with some amount of my changes plus his.</p>\n<p>Still can’t get Mailgun to work.</p>"}},{"node":{"id":"8394be89-bc39-595c-97eb-8c22c3bc2e16","frontmatter":{"name":"John","email":"2c31a17682b8685d630f31f2ec43f7bb","friendlyDate":"February 18, 2017","iso8601Date":"2017-02-18T04:34:34.994Z","published":null},"html":"<p>Nice tutorial. Thanks.</p>"}},{"node":{"id":"8253177f-f57d-57a8-9d03-1733822c8d42","frontmatter":{"name":"Chuck Masterson","email":"08ed66551d57a545c0d07b7b659e4076","friendlyDate":"March 03, 2017","iso8601Date":"2017-03-03T13:46:54.581Z","published":null},"html":"<p>You said you got comment notifications working… I’m going to test them out\nhere and see if I get notified. I’ve been trying to get this working on my own\nsite and don’t understand how the two uses of <code class=\"language-text\">options[parent]</code> don’t conflict.</p>"}},{"node":{"id":"22236dd9-1e59-5f46-92f5-fc6f0645f2b4","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 03, 2017","iso8601Date":"2017-03-03T15:10:21.918Z","published":null},"html":"<p>My understanding is <code class=\"language-text\">options[parent]</code> are <code class=\"language-text\">options[origin]</code> are two different\nthings, the later used to track which thread you’re currently subscribed to. But\nnot entirely sure if that’s how it works since I haven’t had a lot of luck fully\ntesting email notifications.</p>\n<p>Let me know if you get a notification once this comment is merged in and posted.</p>"}},{"node":{"id":"0c19f9b4-292a-5889-9f2e-a334298a1497","frontmatter":{"name":"John","email":"d61e23032f71d8620bd1e33168d235cf","friendlyDate":"March 07, 2017","iso8601Date":"2017-03-07T10:09:51.121Z","published":null},"html":"<p>Can I know when timestamp value is made in comment data file? It is hard to\ncheck it but looks important to show the comment order correctly.</p>"}},{"node":{"id":"be4f67a3-fe43-53c9-95d4-18f9c5bc12f1","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 07, 2017","iso8601Date":"2017-03-07T12:36:14.630Z","published":null},"html":"<p>The timestamp is appended to the data file by Staticman when its received. You\nhave to\n<a href=\"https://staticman.net/docs/configuration#generatedFields\">enable it in your config</a>\nunder the <code class=\"language-text\">generatedFields</code> array. There’s a couple of different formats you can\nuse… I went with <code class=\"language-text\">iso8601</code>.</p>"}},{"node":{"id":"0a3f5917-c373-502a-a68c-91081a070e42","frontmatter":{"name":"Chris","email":"d61e23032f71d8620bd1e33168d235cf","friendlyDate":"March 08, 2017","iso8601Date":"2017-03-08T10:40:45.854Z","published":null},"html":"<p>How do you apply reCaptcha for staticman? Now it is always showing “Missing\nreCAPTCHA API credentials” I encrypted secret using staticman.</p>"}},{"node":{"id":"995acfbd-deb4-5981-913a-76b447f5efa2","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 08, 2017","iso8601Date":"2017-03-08T13:10:50.753Z","published":null},"html":"<p>I had the same issue. Apparently there was an API change with the latest release\nof Staticman. In the form, changing<code class=\"language-text\">options[reCaptcha][encryptedSecret]</code> to\n<code class=\"language-text\">options[reCaptcha][secret]</code> fixed it for me.</p>\n<p>There’s an\n<a href=\"https://github.com/eduardoboucas/staticman/issues/20#issuecomment-284151035\">open issue</a>\non the Staticman repo if that doesn’t end up solving it for you.</p>"}},{"node":{"id":"2344944c-355b-5c44-9455-1eed41e819ba","frontmatter":{"name":"Chris","email":"d61e23032f71d8620bd1e33168d235cf","friendlyDate":"March 09, 2017","iso8601Date":"2017-03-09T09:33:31.585Z","published":null},"html":"<p>Fixed. Thanks for comment. =)</p>"}},{"node":{"id":"e92bd891-6b08-58a4-8de3-93a4e2286424","frontmatter":{"name":"Sukil","email":"4c4618d7d5e47b4587fa422e3d83508c","friendlyDate":"March 10, 2017","iso8601Date":"2017-03-10T00:03:23.642Z","published":null},"html":"<p>Michael, please, can you explain the <code class=\"language-text\">page__comments</code> snippet? If it just checks\nif the parent is <code class=\"language-text\">nil</code>, how does it display all comments? (I’m definitely\nmissing something obvious here, but hey, it’s 1 AM).</p>\n<p>Thanks for the tutorial! One tip though: the required fields should have a\n<code class=\"language-text\">required</code> attribute. You know, for accessibility :) .</p>"}},{"node":{"id":"ecab5b13-9a2a-575e-854d-21453aaa8460","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 10, 2017","iso8601Date":"2017-03-10T01:20:34.790Z","published":null},"html":"<p>Sure thing. That first <code class=\"language-text\">assign</code> is creating an array of comments that don’t have\na <code class=\"language-text\">replying_to</code> field. That’s what the <code class=\"language-text\">nil</code> is checking since through some\ntrial and error I learned that a <code class=\"language-text\">replying_to</code> field is only added to a child\ncomment’s data file.</p>\n<p>Inside the first loop I check the current comment’s value against all comment’s\n<code class=\"language-text\">replying_to</code> fields, if they match then they’re a child and spit out as a\nnested entry in the second loop.</p>\n<p>Does that help clear things up?</p>"}},{"node":{"id":"868f9fe0-0cd2-5aa7-b8a8-8cc53f509842","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 10, 2017","iso8601Date":"2017-03-10T01:42:17.350Z","published":null},"html":"<p>And good catch on the <code class=\"language-text\">required</code> attribute, completely missed that.</p>"}},{"node":{"id":"3c5d322c-2e8b-53be-a607-0007f82278d7","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"March 15, 2017","iso8601Date":"2017-03-15T19:43:50.786Z","published":null},"html":"<p>Staticman recently\n<a href=\"https://github.com/eduardoboucas/staticman/issues/20\">added support for reCAPTCHA</a>\nwhich has completely eliminated all of the spam comments that would slip\nthrough. I’m sure Akismet would have done the same, but since it’s not enabled\nfor the public instance of Staticman this was the next best thing.</p>"}},{"node":{"id":"0e651829-faea-57a9-8f08-0c3a343f8475","frontmatter":{"name":"Lee","email":"58ef23e64467397de44235e5a5a4dd0d","friendlyDate":"March 25, 2017","iso8601Date":"2017-03-25T15:54:20.674Z","published":null},"html":"<p>This is really helpful thanks.</p>"}},{"node":{"id":"1ffdf79a-9d07-5f51-a5d5-90baaa06937f","frontmatter":{"name":"John","email":"d61e23032f71d8620bd1e33168d235cf","friendlyDate":"April 01, 2017","iso8601Date":"2017-04-01T07:03:58.305Z","published":null},"html":"<p>How did you apply mail notification? I already encrypted api key and domain\ncorrectly, though not having luck until now.</p>"}},{"node":{"id":"79b5efaf-d862-5af4-ae6c-05355290d837","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"April 02, 2017","iso8601Date":"2017-04-02T23:22:32.401Z","published":null},"html":"<p>I use the public instance of Staticman which means I didn’t have to create my\nown Mailgun account and encrypt keys. I didn’t have much luck getting it to work\nwhich is why I went that way.</p>\n<p>I don’t know many people who have gotten it to work. Might be worth pinging\n<a href=\"https://github.com/eduardoboucas/staticman/issues/42#issuecomment-287597695\">this thread</a>\nas you’re certainly not alone in trying to get it up and running.</p>"}},{"node":{"id":"fdbfa3a8-2453-5249-aaec-b4cdd102cf9f","frontmatter":{"name":"John","email":"d61e23032f71d8620bd1e33168d235cf","friendlyDate":"April 08, 2017","iso8601Date":"2017-04-08T04:56:44.804Z","published":null},"html":"<p>It looks it is impossible to implement public instance of mailgun for now,\nsadly.</p>"}},{"node":{"id":"ffd46b09-d875-5ae6-b15e-ed77b65daedb","frontmatter":{"name":"Matt Seemon","email":"09d1cc2c678124c06dd0ab1a0351f665","friendlyDate":"April 20, 2017","iso8601Date":"2017-04-20T03:18:38.897Z","published":null},"html":"<p>Extremely helpful. Thank you.</p>"}},{"node":{"id":"3f3815ab-f945-533f-b056-c66be3f6f5d0","frontmatter":{"name":"Matt Seemon","email":"09d1cc2c678124c06dd0ab1a0351f665","friendlyDate":"April 26, 2017","iso8601Date":"2017-04-26T02:07:16.150Z","published":null},"html":"<p>Hey Michael, I could use some help here. The below line is always assigning\ncomments variable as blank.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{% assign comments = site.data.comments[page.slug] | where_exp: &#39;item&#39;, &#39;item.replying_to == blank&#39; %}</code></pre></div>\n<p>If I do an inspect</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{{ site.data.comments[page.slug] | inspect }}</code></pre></div>\n<p>I get this</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{&quot;comment1493146261009&quot;=&gt;{&quot;_id&quot;=&gt;&quot;2029eee0-29e8-11e7-9eac-4b33388ae63e&quot;, &quot;_parent&quot;=&gt;&quot;http://localhost:4000/blog/karaoke/2017/04/25/Latest-tracks.html&quot;, &quot;name&quot;=&gt;&quot;Matt Seemon&quot;, &quot;email&quot;=&gt;&quot;09d1cc2c678124c06dd0ab1a0351f665&quot;, &quot;url&quot;=&gt;&quot;https://mattseemon.in&quot;, &quot;message&quot;=&gt;&quot;Testing Staticman Comments&quot;, &quot;replying_to&quot;=&gt;&quot;&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;1493146261}, &quot;comment1493150394000&quot;=&gt;{&quot;_id&quot;=&gt;&quot;bf915780-29f1-11e7-9eac-4b33388ae63e&quot;, &quot;_parent&quot;=&gt;&quot;http://localhost:4000/blog/karaoke/2017/04/25/Latest-tracks.html&quot;, &quot;name&quot;=&gt;&quot;Matt Seemon&quot;, &quot;email&quot;=&gt;&quot;09d1cc2c678124c06dd0ab1a0351f665&quot;, &quot;url&quot;=&gt;&quot;https://mattseemon.in&quot;, &quot;message&quot;=&gt;&quot;One more test&quot;, &quot;replying_to&quot;=&gt;&quot;&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;1493150393}}</code></pre></div>\n<p>Other than that, all the settings are exactly the same, except for file name and\nthe date format.</p>"}},{"node":{"id":"838c117f-d785-5853-b8a8-32401cc3da18","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"April 26, 2017","iso8601Date":"2017-04-26T02:21:54.432Z","published":null},"html":"<p>Add an <code class=\"language-text\">inspect</code> on the <code class=\"language-text\">comments</code> array instead, since that will be the new\narray that is filtering out replies with <code class=\"language-text\">where_exp</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"liquid\"><pre class=\"language-liquid\"><code class=\"language-liquid\">{{ comments <span class=\"token operator\">|</span> inspect }}</code></pre></div>\n<p>For comparison this is an example of what I get:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[{&quot;id&quot;=&gt;&quot;comment-1047796157&quot;, &quot;date&quot;=&gt;2013-09-17 07:07:59 -0400, &quot;updated&quot;=&gt;2013-09-17 07:07:59 -0400, &quot;post_id&quot;=&gt;&quot;/going-static&quot;, &quot;name&quot;=&gt;&quot;picajoso&quot;, &quot;url&quot;=&gt;&quot;&quot;, &quot;message&quot;=&gt;&quot;Do you think Jekyll is suitable for a heavy updated site? If you have to build the whole website each time you publish something then this option wouldn&#39;t be acceptable. I&#39;ve read somewhere that there is someway to build only the updated/new posts, maintaining the rest of the site without changes.&quot;, &quot;avatar&quot;=&gt;&quot;https://disqus.com/api/users/avatars/picajoso.jpg&quot;}]</code></pre></div>"}},{"node":{"id":"7d4c0d41-8d96-5e3b-82b2-9a1da8bfb080","frontmatter":{"name":"Matt Seemon","email":"09d1cc2c678124c06dd0ab1a0351f665","friendlyDate":"April 26, 2017","iso8601Date":"2017-04-26T02:50:52.060Z","published":null},"html":"<p>Did that as well, and all I get is</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[]</code></pre></div>"}},{"node":{"id":"2db5877c-978f-5f31-a980-8c7dc117bd64","frontmatter":{"name":"Matt Seemon","email":"09d1cc2c678124c06dd0ab1a0351f665","friendlyDate":"April 26, 2017","iso8601Date":"2017-04-26T13:53:55.597Z","published":null},"html":"<p>OK.. So I sort of figured out where the problem lies… While the <code class=\"language-text\">where_exp</code> is\nnot working for me as it does for you, I had to take a different approach.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{% assign idx = 0 %}\n{% for comment in site.data.comments[page.slug] %}\n  {% if comment[1].replying_to == &quot;&quot; %}\n    {% assign idx         = idx | plus: 1 %}\n    {% assign index       = idx %}\n    {% assign r           = comment[1].replying_to %}\n    {% assign replying_to = r | to_integer %}\n    {% assign email       = comment[1].email %}\n    {% assign name        = comment[1].name %}\n    {% assign url         = comment[1].url %}\n    {% assign date        = comment[1].date %}\n    {% assign message     = comment[1].message %}\n    {% include comment.html index=index replying_to=replying_to email=email name=name url=url date=date message=message %}\n  {% endif %}\n{% endfor %}</code></pre></div>"}},{"node":{"id":"a1e45b36-099f-54ee-a28e-6e6d3c0db434","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"April 26, 2017","iso8601Date":"2017-04-26T15:28:37.607Z","published":null},"html":"<p>Are you using replies on your site? You might run into problems eliminating the\n<code class=\"language-text\">where</code> filter since that first loop will include parent comments along with\ntheir children (the replies).</p>\n<p>I had a hell of a time getting it to filter out properly. The <code class=\"language-text\">where</code> and\n<code class=\"language-text\">where_exp</code> filters seem to be really picky if your data array doesn’t match. It\nall comes down to how your data files are constructed. Perhaps yours are\nslightly different than mine.</p>"}},{"node":{"id":"3db98571-044e-5ae9-8163-aa50651129de","frontmatter":{"name":"Matt Seemon","email":"09d1cc2c678124c06dd0ab1a0351f665","friendlyDate":"April 27, 2017","iso8601Date":"2017-04-27T05:42:14.324Z","published":null},"html":"<p>Ultimately it boiled down to the fact that since <code class=\"language-text\">where_exp</code> was not working for\nme. With my approach I was receiving each comment as below. Hence the need to\nuse <code class=\"language-text\">[1]</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[&quot;comment-1493177616768&quot;, {&quot;_id&quot;=&gt;&quot;217db4e0-2a31-11e7-9594-27fd6f0988e3&quot;, &quot;_parent&quot;=&gt;&quot;http://mattseemon.dev/blog/karaoke/2017/04/25/Latest-tracks.html&quot;, &quot;name&quot;=&gt;&quot;Matt Seemon&quot;, &quot;email&quot;=&gt;&quot;09d1cc2c678124c06dd0ab1a0351f665&quot;, &quot;url&quot;=&gt;&quot;https://mattseemon.in&quot;, &quot;message&quot;=&gt;&quot;Testing Staticman Comments&quot;, &quot;replying_to&quot;=&gt;&quot;&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-04-26T03:33:36.759Z&quot;}]</code></pre></div>\n<p>It seems to be working with replies as well without anything breaking, so far.\nFingers crossed. I will know once i go live. Thank you for all your help.</p>"}},{"node":{"id":"991a9f47-8cfe-50d2-b9ca-e2de8ba9b007","frontmatter":{"name":"Harry","email":"58dfe5ef6aaf9bf9af5a0b17b52e6168","friendlyDate":"July 13, 2017","iso8601Date":"2017-07-13T07:30:59.942Z","published":null},"html":"<p>Hi, I’m really keen to try out Staticman.</p>\n<p>Is there a tool to import Blogger comments to Staticman/GitHub or any\nsuggestions on how I could go about doing so?</p>\n<p>Thanks for sharing all this wonderful information.</p>"}},{"node":{"id":"33dba3f8-f671-52dc-aeb0-3adcf3cf014e","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"July 13, 2017","iso8601Date":"2017-07-13T12:32:58.640Z","published":null},"html":"<p>I used this set of Rake tasks to\n<a href=\"https://github.com/pathawks/jekyll-disqus-comments\">export comments in Disqus</a>\nto use with Staticman. Perhaps it can be modified to do the same with Blogger.</p>\n<p>Blogger lets you\n<a href=\"https://support.google.com/blogger/answer/41387?visit_id=1-636355458136931298-4026338400&#x26;rd=1\">export your blog into an XML file</a>\nwhich you could probably pull data out of. Not sure if it includes all the\ncomments though. Jekyll has a Blogger\n<a href=\"http://import.jekyllrb.com/docs/blogger/\">import tool</a> so perhaps you can get\nsome ideas from that?</p>"}},{"node":{"id":"91bec741-4f07-5fd6-8aa6-189f9fa1670e","frontmatter":{"name":"Harry","email":"58dfe5ef6aaf9bf9af5a0b17b52e6168","friendlyDate":"July 15, 2017","iso8601Date":"2017-07-15T19:26:14.390Z","published":null},"html":"<p>Thanks a lot, Michael. I managed to get the comments imported. I first imported\nthe comments from Blogger to Disqus, and then used your approach to export them\nout of Disqus.</p>\n<p>I’m now on to configuring reply-to. I managed to get it to work but running into\nan issue. When running in production mode, my comments are appearing in the\ncorrect order but when running on localhost, they are order is different and the\nreply is showing up under the wrong parent. It seems that the order in which the\ncomments are being returned are different on localhost and production. Any idea\nwhy that would happen?</p>\n<p>I’m also not sure why you are not using the unique id of the parent as the\nreply-to value on the child to guarantee that the child is attached to the\ncorrect parent.</p>\n<p>Thanks.</p>"}},{"node":{"id":"05e7e5f3-6f2a-5599-acc9-9a5509af9992","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"July 15, 2017","iso8601Date":"2017-07-15T22:44:03.481Z","published":null},"html":"<p>Great!</p>\n<p>Not sure what could be going on with the comment order. I’ve heard of others\nhaving the same issue so you’re not alone. If you’re using the same instance of\nJekyll to build and serve then the output should be exactly the same. If you’re\nusing some sort of CI service to build/deploy your site then it’s possible the\nenvironments and Jekyll versions are out of sync and that’s the issue.</p>\n<p>I am using unique id’s to attach child comments to their parent by using the\n<code class=\"language-text\">replying_to</code> field. There’s a chance my code above is old and outdated. If you\nhaven’t already, reference my GitHub repo instead since that is the actual code\nI use to build comments on my site.</p>\n<ul>\n<li><a href=\"https://github.com/mmistakes/made-mistakes-jekyll/blob/master/src/_includes/comments.html\"><code class=\"language-text\">_includes/comments.html</code></a></li>\n<li><a href=\"https://github.com/mmistakes/made-mistakes-jekyll/blob/master/src/_includes/comment.html\"><code class=\"language-text\">_includes/comment.html</code></a></li>\n</ul>"}},{"node":{"id":"12e64f15-1a45-5593-9d77-8f358f52d3c1","frontmatter":{"name":"Harry","email":"58dfe5ef6aaf9bf9af5a0b17b52e6168","friendlyDate":"July 16, 2017","iso8601Date":"2017-07-16T04:38:19.350Z","published":null},"html":"<p>I really appreciate your help.</p>\n<p>You are right that I’m using a CI service, but after some more testing, I found\nthat the ordering of replies is completely unpredictable and it is changing both\non my local and on the production. I’m on the latest version of Jekyll (3.5).\nMaybe that’s causing the difference. BTW, I have been using the latest code from\nyour GH repo.</p>\n<p>So I made a minor modification to your code to use the parent’s <code class=\"language-text\">_id</code> field as\nthe replying-to value of the child, instead of relying on the position of the\ncomments (because that seems to be unpredictable at least in my environment).\nNow it seems to be working consistently.</p>\n<p>I’m yet to get into reply notifications and MailGun setup. If I run into any\nissues, I may seek your help again.</p>\n<p>I must say that your 2 blog posts on Staticman have been extremely helpful.\nWithout your posts I may not have even made a serious attempt at it.</p>\n<p>I don’t have enough words to thank you!”</p>"}},{"node":{"id":"63e15895-ebe5-585e-9f72-1061131c3bb8","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"July 16, 2017","iso8601Date":"2017-07-16T14:42:19.949Z","published":null},"html":"<p>There’s one more thing I forgot about that I didn’t write up in the posts. If\nyou have a page with imported Disqus comments (using the Rake task) and new ones\nfrom Staticman the order will be wrong because of filename differences.</p>\n<p>What’s going on is the order is determined by the comment data files’ filenames.\nThe data files created from the Disqus import use a different format\n(<a href=\"https://en.wikipedia.org/wiki/ISO_8601\">ISO 8601</a>) than the ones Staticman\ngenerates (<a href=\"https://en.wikipedia.org/wiki/Unix_time\">UNIX timestamp</a> in\nmilliseconds). I fixed that by\n<a href=\"https://github.com/mmistakes/made-mistakes-jekyll/commit/569a16112ba08fa9e79ee535a642d7e4c0160d8c\">renaming all of my Disqus comment filenames</a>\nto match.</p>\n<p>What you could do is modify the script to use a Unix time format (not\n<code class=\"language-text\">YYYY-MM-DD</code>) or change Staticman’s <code class=\"language-text\">filename</code> config to use something other\nthan the\n<a href=\"https://staticman.net/docs/configuration#path\">default <code class=\"language-text\">{@timestamp}</code> placeholder</a>.</p>\n<p>If you’re looking for help with getting Mailgun notifications working I’d check\nout Staticman’s repo. I’m using the public instance so no issues really for me,\nbut I know a lot of people have had problems getting it to work. You’ll likely\nfind more guidance on\n<a href=\"https://github.com/eduardoboucas/staticman/issues/42\">this issue’s thread</a> than\nfrom me.</p>"}},{"node":{"id":"c3d3205b-ef6e-5086-81ee-354dc0be5742","frontmatter":{"name":"Gonzalo Ziadi","email":"84028d1c4d05a0a226a38be5e72803dd","friendlyDate":"July 26, 2017","iso8601Date":"2017-07-26T13:40:01.764Z","published":null},"html":"<p>Michael, thanks a ton for this post! I used it as the base for my own\nimplementation. Some things I\nhad to change:</p>\n<ul>\n<li><code class=\"language-text\">&quot;item.replying_to == &#39;&#39;&quot;</code> rather than <code class=\"language-text\">&quot;item.replying_to == blank&quot;</code></li>\n<li><code class=\"language-text\">{% assign comments = site.data.comments[page.slug] | where_exp:&quot;item&quot;, &quot;item.replying_to == &#39;&#39;&quot; | sort: &#39;date&#39; %}</code>\nrather than\n<code class=\"language-text\">{% assign comments = site.data.comments[page.slug] | where_exp:&quot;item&quot;, &quot;item.replying_to == blank&quot; %}</code>\nas even though I followed your comment naming convention, posts were being\nsorted in reverse alphabetical order so the replies were showing under the\nwrong parent comment. Now that I think about it maybe | reverse would work the\nsame as | sort <code class=\"language-text\">date</code> in my case.</li>\n</ul>\n<p>I also tried to use the comment <code class=\"language-text\">_id</code> field as the “link” between child and\nparent rather than the for loop index, but I kept getting errors about ‘nesting\ntoo deep’. I feel like using the <code class=\"language-text\">_id</code> field would be better though as then\nsorting the comments by date or some other parameter would become doable. What\ndo you think?</p>\n<ul>\n<li>I didn’t want to use jQuery so I changed a bit how the replies work. Same\nconcept, different implementation.</li>\n<li>I changed the CSS a little, but it is heavily inspired by yours.</li>\n<li>I changed the website input type to text instead of url. The url regex is\nannoying, to me, as it requires users to put the http:// in front of their\nurl. I feel like they shouldn’t have to do this.</li>\n</ul>\n<p>If it piques your curiosity in the very least, in my <code class=\"language-text\">_includes</code> folder I have\nyour same three files (comments, comment, and comment-form) and in my <code class=\"language-text\">_layouts</code>\nfolder in <code class=\"language-text\">default.html</code> in a script tag at the bottom of the file I have the js\ncode for the replies. Thanks again!”</p>"}},{"node":{"id":"24110df1-7a94-588e-8ba4-a2666538eff6","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"July 26, 2017","iso8601Date":"2017-07-26T14:26:53.005Z","published":null},"html":"<p>Thanks for sharing! I’ve heard from a few people that they had to modify the\n<code class=\"language-text\">for</code> loop to get the nested order sorted out. Something not mentioned in this\npost is I did some additional cleanup on my comment data\n(<a href=\"https://mademistakes.com/articles/improving-jekyll-static-comments/#comment-16-5\">see this reply</a>).</p>\n<p>Some of the variation might have to do with your comment data too and how Liquid\nconditionals are met.\n<a href=\"https://shopify.github.io/liquid/basics/truthy-and-falsy/\">Truthy/falsy</a> values\nfor strings, integers, arrays, etc. are different.</p>\n<p>I encountered the same <code class=\"language-text\">nesting too deep</code> errors as I tried a million different\ncombinations of Jekyll’s <code class=\"language-text\">where</code> and <code class=\"language-text\">where_exp</code> filters. There have been some\nupdates Jekyll so maybe it’s worth revisiting.</p>"}},{"node":{"id":"989a4daa-2299-585e-8091-e23fa72e3c70","frontmatter":{"name":"Harry","email":"58dfe5ef6aaf9bf9af5a0b17b52e6168","friendlyDate":"August 14, 2017","iso8601Date":"2017-08-14T02:48:24.865Z","published":null},"html":"<p>Thanks, Michael.</p>\n<p>You are right that Disqus comments and staticman comments have different file\nnaming conventions, but I haven’t encountered any issue with that. I use the\ndate inside each comment file to sort the comments in the right order. So, file\nname doesn’t seem to matter much.</p>\n<p>I do have 2 questions for you -</p>\n<ol>\n<li>I had recaptcha enabled for my staticman comments, but Page Speed checks do\nnot seem to like recaptcha for various reasons (no browser caching etc.). So\nI experimented with disable recaptcha and falling back on the honey pot\nmethod. Within 6 hours, I received 4 spam comments. This tells me that honey\npot is not as effective as recaptcha in dealing with spam. However, Eduardo\nBoucas himself is not using recaptcha on his blog, and he has commented on\nthe issue thread, which you linked in your reply, that honey pot has worked\nwell for him. So, I wanted to know your experience with it.</li>\n<li>Comment replies - I’m concerned about using comment replies because I’m\nwondering what if I put someone else’s email address and subscribe to comment\nreplies. Wouldn’t that start spamming the mailbox of the person who owns the\nemail address? Is there some kind of email verification involved when you\nsubscribe to replies? I don’t seem to recollect there was one when I signed\nup for replies on this thread.</li>\n</ol>\n<p>Thanks again.</p>"}},{"node":{"id":"650e2a0c-3781-5e13-a697-457bd9271794","frontmatter":{"name":"Michael Rose","email":"1ce71bc10b86565464b612093d89707e","friendlyDate":"August 14, 2017","iso8601Date":"2017-08-14T12:06:23.040Z","published":null},"html":"<p>I wouldn’t worry too much about the script getting flagged by page speed testers\n— the scores they assign aren’t as black and white as they make it seem. It’s\nbeing loaded asynchronously and I haven’t seen it hurt my pages much if any.</p>\n<p>The honeypot method is too easy for bots to spoof. They eventually learn what\nthe hidden field is that you’re trying to fool them with. I was getting over 10\nspam comments a day on my posts. Turning on reCAPTCHA I get maybe 2 a week. Spam\nthat slips through is usually people manually trying to stuff a comment with\ntheir links, on posts like this that tend to rank well in search.</p>\n<p>Reply notifications are totally something that could be abused. You’re right\nsomeone could easily put any email address they wanted into the form. I believe\nI saw someone over in\n<a href=\"https://github.com/eduardoboucas/staticman/issues\">Staticman’s issues on GitHub</a>\nvoiced the same concern and suggesting some sort of double opt’in feature.</p>\n<p>Regardless I believe the notification emails that come from Staticman have an\nunsubscribe link, so it should be easy enough to stop them.</p>"}},{"node":{"id":"70255e85-5912-5544-b42a-186673219cf7","frontmatter":{"name":"Harry","email":"58dfe5ef6aaf9bf9af5a0b17b52e6168","friendlyDate":"August 14, 2017","iso8601Date":"2017-08-14T14:03:28.871Z","published":null},"html":"<p>Thanks, Michael. I’m going to first re-enable Recaptcha as I don’t think the\nhoney pot is sweet enough. About reply notification, I guess you are right that\nthe unsubscribe option should mitigate the risk. I’ll give it a shot and see how\nit goes.</p>\n<p>One other thought I had was to make use of browser local storage to store\ncommenter’s Name, Email and Website so that return visitors who have commented\nbefore do not have to type those details again (as long as they don’t clear\ntheir cache). What do you think about that?</p>"}},{"node":{"id":"5831acce-b253-5d71-a43e-8931a01b02f8","frontmatter":{"name":"Radek","email":"b4d3a26373c238de81eb913b593b6826","friendlyDate":"August 26, 2017","iso8601Date":"2017-08-26T17:04:02.414Z","published":null},"html":"<p>Many thanks for this article. After Pooleapp died I thought I was sentenced to\nDisqus again. Staticman to the rescue !!</p>"}}]}},"pageContext":{"next":{"frontmatter":{"path":"/notes/static-files/","title":"Accessing static files in Jekyll","categories":["notes"],"tags":["TIL","web development","Jekyll"]},"fileAbsolutePath":"/home/28041/opensource/github.com/mmistakes/made-mistakes-gatsby/src/posts/notes/static-files.md"},"previous":{"frontmatter":{"path":"/notes/kramdown-table-html/","title":"HTML inside Kramdown table cells","categories":["notes"],"tags":["TIL","web development","Jekyll"]},"fileAbsolutePath":"/home/28041/opensource/github.com/mmistakes/made-mistakes-gatsby/src/posts/notes/kramdown-table-html.md"}}}}